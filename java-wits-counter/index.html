<!doctype html><html lang=en-us><head><meta charset=utf-8><title>WitsCounter</title>
<meta name=description content="A Java application to count Wits parameters throughput in real time."><script async src="https://www.googletagmanager.com/gtag/js?id=G-00ERBL6RH1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-00ERBL6RH1")</script><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://wandercosta.com/index.xml title=WanderCosta><meta name=twitter:card content="summary"><meta name=twitter:title content="WitsCounter"><meta name=twitter:description content="A Java application to count Wits parameters throughput in real time."><link rel=stylesheet href=https://wandercosta.com/fontawesome/css/all.min.css><link crossorigin=anonymous href=/css/styles.min.css integrity rel="preload stylesheet" as=style><link id=dark-mode-theme crossorigin=anonymous href=/css/dark.min.css integrity rel="preload stylesheet" as=style><script>var darkTheme=document.getElementById("dark-mode-theme"),storedTheme=localStorage.getItem("dark-mode-storage");storedTheme==="dark"?darkTheme.disabled=!1:storedTheme==="light"&&(darkTheme.disabled=!0)</script><script defer crossorigin=anonymous src=/js/theme.js integrity></script><script defer crossorigin=anonymous src=/js/instantpage.min.js integrity></script><meta name=generator content="Hugo 0.136.3"></head><body><header><nav class=navbar><div class=nav><a href=https://wandercosta.com/ class=nav-logo><img src=https://wandercosta.com/images/logo-64.jpg width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/about/ id=About><em class="fas fa-user fa-lg"></em></a></li><li><a href=/tags id=Tags><em class="fas fa-tag fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=posts-heading><h1>WitsCounter</h1></div></div></div></header><div class=container role=main><article class=article class=blog-post><img src=/img/post-bg-rig2.jpg><p>Recently, I published a post of an application called <a href=../java-witsgenerator>WitsGenerator</a> to provide random Wits data through a TCP port. Today I&rsquo;m publishing another application related to the Oil & Gas business, but now it&rsquo;s to count the amount of parameters being transmitted through Wits.</p><p>For this project, I&rsquo;m using:</p><ul><li>Java JDK 8u73;</li><li>Maven 3.3.9.</li></ul><p>This <a href=https://github.com/rwanderc/wits-counter>code</a> is also available in my <a href=https://github.com/rwanderc>GitHub</a> page. Feel free to comment if you have any doubt or suggestion. &#x1f604;</p><h3 id=licensing>Licensing</h3><p>This software is licensed under the MIT license, what basically means that you can use it for any purpose <em><strong>without any warranty</strong></em>. &#9888;&#xfe0f;</p><h1 id=functionality>Functionality</h1><p>This simple application provides 2 different information:</p><ul><li>The total amount of parameters per time interval;</li><li>The amount of different parameters per time interval.</li></ul><p><img src=/img/post-img-java-witscounter-printscreen1.jpg alt=post-img-java-witscounter-printscreen1.jpg></p><h1 id=architecture>Architecture</h1><p>The application works as an implementation of Producer-Consumer over a matrix data structure. This matrix works as a memory and each cell of this matrix represents, in any given moment, the amount of record-item received for that position since last matrix clean up. If the number 3 is found in the position <code>0x0</code>, it means that the <code>record 1 item 1</code> was received 3 times since the last matrix clean up. If the number 2 is found in the position <code>9x3</code>, it means that the <code>record 10 item 4</code> was received 2 times since the last matrix clean up.
To count the total amount of items received in a given moment, it&rsquo;s necessary to do a big sum of all the values present in the matrix. To count the number of unique items received in a given moment, it&rsquo;s necessary to do a sum of the number of cells which values differs to 0.
This matrix is based in the type <code>byte</code>, that offers good sizing for big amount of time, and, at the same time, is cheaper in terms of memory.</p><p>The Producer-Consumer aspect comes from the way the matrix is used: one thread keeps reading data from the Wits server and adds into the matrix, while another thread, from time to time, counts the total and unique values in the matrix and cleans it up.</p><p>Thus, there are 5 important classes:</p><ul><li><strong>WitsCounter.java</strong>: is the class that orchestrates the start/stop of the resources;</li><li><strong>WitsMatrixCounter.java</strong>: is the implementation of the matrix used to store current counters;</li><li><strong>WitsCountConsumer.java</strong>: is the class responsible for consuming the data from the matrix and printing into the console;</li><li><strong>WitsCountProducer.java</strong>: is the class responsible for reading the data from the socket and adding to the matrix;</li><li><strong>TCPClient.java</strong>: is the representation of the TCP connection to the Wits server.</li></ul><p>The usage is as follow:</p><p>{% highlight text %}
Usage: java -jar wits-counter-1.1.jar [host] [port] [interval]
Connects to a Wits server through TCP Socket and prints the number
of parameters being received per time interval. It does not
reconnect if the connection fails.
[host] The IP of hostname of the server
[port] The port of the server
[interval] The time interval, in milliseconds, to aggregate
values. If less or equal 0, 1000 is used.
{% endhighlight %}</p><p>When executed, it will start a TCP Client socket client to the data provider, and will start counting the parameters being received.
No major treatment is done in the inputs, so you may have errors when wrong/unreal parameters are passed.</p><h1 id=code>Code</h1><p>I&rsquo;m not attaching here the Main.class. If necessary, visit my <a href=https://github.com/rwanderc>GitHub</a> page.</p><h4 id=witscounterjava>WitsCounter.java</h4><script src=https://gist.github.com/rwanderc/117f0ce00d60832d9d50e2043284f881.js></script><h4 id=witsmatrixcounterjava>WitsMatrixCounter.java</h4><script src=https://gist.github.com/rwanderc/2440e3e83c16c5d2b201139b2caaf2b8.js></script><h4 id=witscountconsumerjava>WitsCountConsumer.java</h4><script src=https://gist.github.com/rwanderc/4cbd7dedaca99f0257e131c5a3b3f7f2.js></script><h4 id=witscountproducerjava>WitsCountProducer.java</h4><script src=https://gist.github.com/rwanderc/7a7bb59971d89cc18f8811b4f2bcbd8b.js></script><h4 id=tcpclientjava>TCPClient.java</h4><script src=https://gist.github.com/rwanderc/5c5e4dc98d0ff46d1d809c85dbeeb92b.js></script><div class=blog-tags><a href=https://wandercosta.com/tags/java/>java</a>&nbsp;
<a href=https://wandercosta.com/tags/og/>O&amp;G</a>&nbsp;</div></article><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="wandercosta",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><footer><div class=social-icons><a href=/index.xml name=feed><em class="fa fa-rss-square"></em>
</a>&nbsp;&ndash;&nbsp;
<a href=mailto:contact@wandercosta.com name=email><em class="fas fa-envelope"></em>
</a>&nbsp;&ndash;&nbsp;
<a href=https://twitter.com/rwanderc name=twitter><em class="fab fa-twitter"></em>
</a>&nbsp;&ndash;&nbsp;
<a href=https://github.com/rwanderc name=github><em class="fab fa-github"></em>
</a>&nbsp;&ndash;&nbsp;
<a href=https://www.linkedin.com/in/rwanderc name=linkedin><em class="fab fa-linkedin"></em></a></div><div class=container><p class="credits copyright"><a href=https://wandercosta.com/about></a>&nbsp;&copy;
2030
&nbsp;/&nbsp;
<a href=https://wandercosta.com/>WanderCosta</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>